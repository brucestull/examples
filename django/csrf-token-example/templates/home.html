{% extends 'base.html' %}

{% block title %}Django CSRF Token Example{% endblock title %}

{% block content %}

    <h1>CSRF Example</h1>

    {% if user.is_authenticated %}
        <p>Greetings, {{ user.username | capfirst }}!</p>
        <a href={% url 'logout' %}>Log Out, Right MEOW!</a>
    {% else %}
        <p>You are not logged in, unfortunately.</p>
        <a href={% url 'login' %}>Log In, please...</a><br>
        <a href={% url 'signup' %}>Sign Up, maybe...</a><br>
    {% endif %}

    {% csrf_token %}

    <main id='app'>
        <h2>[[ name ]]</h2>
    </main>

    <!--JavaScript at end of body for optimized loading-->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <!-- My JS -->
    <script>
        // Start server:
        // python -m http.server 8000
        const vm = new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            data: {
                name: 'Vue Application!',
                csrf_token: '',
            },
            methods: {

            },
            computed: {

            },
            beforeCreate: function() {
                console.log("About to Create!")
            },
            created: function() {
                console.log("Created")
            },
            beforeMount: function() {
                console.log("About to Mount!")
            },
            mounted: function() {
                console.log("Mounted")
                this.csrf_token = document.querySelector("input[name=csrfmiddlewaretoken]").value
            },
            beforeUpdate: function() {
                console.log("About to Update!")
            },
            updated: function() {
                console.log("Updated")
            },
            beforeDestroy: function() {
                console.log("About to Destroy!")
            },
            destroyed: function() {
                console.log("Destroyed")
            },
        })
    </script>

{% endblock content %}
