<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDos Conglomerate</title>
</head>
<body>
    <nav>
        <a href="">Home</a><br>
        <a href="/admin/" target="_blank">Django Admin Interface</a><br>
        <a href="/api/v1/todos/" target="_blank"><code>todos</code> - Django Browsable API</a><br>
        <a href="http://localhost:8000/admin/todos/todo/" target="_blank">ToDos - Django Admin Interface</a><br>
    </nav>
    <main id="app">
        <p>[[ weGottaStartSomewhere ]]</p>

        <h2>The Obligatory Big List!</h2>
        <item-component></item-component>

        <h2>Raw Items!</h2>
        <p>
            [[ theTodos ]]
        </p>

    </main>
    <footer></footer>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <script>
        // pipenv shell
        // Start server:
        // python manage.py runserver

        Vue.component('item-component', {
            template: `
            <div>
                <p>The Obligatory Item in List</p>
            </div>
            `,
        })

        const vm = new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            data: {
                weGottaStartSomewhere: 'Goodbuy, World! Enjoy the Sail!',
                theTodos: [],
                todosUrl: '/api/v1/todos/'
            },
            methods: {
                loadTodosGet: function() {
                    axios.get(
                        this.todosUrl
                    ).then(response => {
                        console.log('response: ', response)
                        this.theTodos = response.data;
                    }).catch(error => {
                        console.log(error);
                    });
                },
                loadTodos: function() {
                    axios({
                        method: 'get',
                        url: this.todosUrl,
                    }).then(response => {
                        console.log('response: ', response)
                        this.theTodos = response.data;
                    }).catch(error => {
                        console.log(error);
                    });
                },

            },
            computed: {
                todosCount: function() {
                    return this.theTodos.length;
                },

                completedTodosArrow: function() {
                    return this.theTodos.filter(todo => todo.completed);
                },
                completedTodos: function() {
                    return this.theTodos.filter(function(todo) {
                        return todo.completed;
                    });
                },

                incompletedTodosArrow: function() {
                    return this.theTodos.filter(todo => !todo.completed);
                },
                incompletedTodos: function() {
                    return this.theTodos.filter(function(todo) {
                        return !todo.completed;
                    });
                },

            },
            beforeCreate: function() {
                console.log("About to Create!")
            },
            created: function() {
                console.log("Created")
                this.loadTodos();
            },
            beforeMount: function() {
                console.log("About to Mount!")
            },
            mounted: function() {
                console.log("Mounted")
            },
            beforeUpdate: function() {
                console.log("About to Update!")
            },
            updated: function() {
                console.log("Updated")
            },
            beforeDestroy: function() {
                console.log("About to Destroy!")
            },
            destroyed: function() {
                console.log("Destroyed")
            },
        })
    </script>
</body>
</html>